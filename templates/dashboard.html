<!DOCTYPE html>
<html>
<head>
    <title>Analytics Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body class="bg-light">

<div class="container-fluid mt-4">

<h4>Business Analytics Dashboard</h4>

<div class="row text-center mb-4">
    <div class="col-md-3"><div class="card p-3">Total Sales<br>₹{{ summary.total_sales }}</div></div>
    <div class="col-md-3"><div class="card p-3">Total Profit<br>₹{{ summary.total_profit }}</div></div>
    <div class="col-md-3"><div class="card p-3">Units Sold<br>{{ summary.total_units }}</div></div>
    <div class="col-md-3"><div class="card p-3">GST<br>₹{{ summary.total_gst }}</div></div>
</div>

<div class="row">
    <div class="col-md-6"><div id="areaChart"></div></div>
    <div class="col-md-6"><div id="monthChart"></div></div>
</div>

<div class="row mt-4">
    <div class="col-md-12"><div id="productChart"></div></div>
</div>

<form action="/forecast" method="post">
    <input type="hidden" name="data" value='{{ data }}'>
    <button class="btn btn-dark mt-4">Go to Forecast →</button>
</form>

</div>

<script>
    Plotly.newPlot("areaChart", [{
        x: {{ area_sales | tojson | safe }}.map(d => d.area),
        y: {{ area_sales | tojson | safe }}.map(d => d.sale_amount),
        type: "bar"
    }]);

    Plotly.newPlot("monthChart", [{
        x: {{ month_sales | tojson | safe }}.map(d => d.month),
        y: {{ month_sales | tojson | safe }}.map(d => d.sale_amount),
        mode: "lines+markers"
    }]);

    Plotly.newPlot("productChart", [{
        x: {{ product_sales | tojson | safe }}.map(d => d.product),
        y: {{ product_sales | tojson | safe }}.map(d => d.sale_amount),
        type: "bar"
    }]);
</script>

</body>
</html>
